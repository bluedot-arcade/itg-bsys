#!/bin/bash

# ----- Colors -----
GREEN="\033[1;32m"
RED="\033[1;31m"
YELLOW="\033[1;33m"
CYAN="\033[1;36m"
RESET="\033[0m"

# ----- Required Packages -----
REQUIRED_PACKAGES=(
    gamemode
    gamescope
    devilspie2
    mangohud
    unclutter-xfixes
)

# ----- Header -----
echo -e ""
echo -e "${CYAN}==============================================="
echo -e "  Checking Required System Packages"
echo -e "===============================================${RESET}"
echo

# ----- Table Header -----
printf "%-25s %-15s %-20s\n" "PACKAGE" "STATUS" "VERSION"
echo "------------------------------------------------------------------"

# ----- Package Check -----
MISSING=()
for PKG in "${REQUIRED_PACKAGES[@]}"; do
    if dpkg -s "$PKG" &> /dev/null; then
        VERSION=$(dpkg -s "$PKG" | grep '^Version:' | awk '{print $2}')
        printf "%-25s ${GREEN}%-15s${RESET} %-20s\n" "$PKG" "INSTALLED" "$VERSION"
    else
        printf "%-25s ${RED}%-15s${RESET} %-20s\n" "$PKG" "NOT INSTALLED" "-"
        MISSING+=("$PKG")
    fi
done

# ----- Summary -----
echo
if [ ${#MISSING[@]} -eq 0 ]; then
    echo -e "${GREEN}All required packages are installed!${RESET}"
else
    echo -e "${YELLOW}Missing packages detected:${RESET}"
    for PKG in "${MISSING[@]}"; do
        echo -e "   â€¢ ${RED}$PKG${RESET}"
    done
    echo
    echo -e "${CYAN}To install missing packages, run:${RESET}"
    echo -e "   ${YELLOW}sudo apt install ${MISSING[*]}${RESET}"
fi

echo
